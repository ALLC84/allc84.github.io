---
import { Image } from 'astro:assets';
import contactData from '@data/contact.js';

const STATUS = {
  available:   { label: 'disponible',            color: 'var(--accent-green)',     pulse: true  },
  open:        { label: 'abierto a oportunidades', color: 'var(--accent-secondary)', pulse: true  },
  unavailable: { label: 'no disponible',          color: 'var(--dr-comment)',       pulse: false },
};

const { label, color, pulse } = STATUS[contactData.status] ?? STATUS.available;
---

<div class="avatar-wrap">
  <div class="avatar-ring">
    <Image
      class="avatar-img"
      src={contactData.image}
      alt={`Avatar ${contactData.name}`}
      width="72"
      height="72"
    />
  </div>
  <div class="avatar-meta">
    <span class="avatar-name">{contactData.name}</span>
    <span class="avatar-status" style={`color: ${color}`}>
      <span class:list={['status-dot', { 'status-dot--pulse': pulse }]} style={`background: ${color}`}></span>
      {label}
    </span>
  </div>
</div>

<style>
.avatar-wrap {
  display: flex;
  align-items: center;
  gap: var(--space-sm);
  width: 100%;
}

.avatar-ring {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  padding: 2px;
  background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
  flex-shrink: 0;
}

.avatar-img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 50%;
  border: 2px solid var(--bg-sidebar);
  display: block;
}

.avatar-meta {
  display: flex;
  flex-direction: column;
  gap: 2px;
  min-width: 0;
}

.avatar-name {
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-bold);
  color: var(--text-main);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.avatar-status {
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: var(--font-size-xs);
}

.status-dot {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  flex-shrink: 0;
}

.status-dot--pulse {
  animation: pulse-dot 2s ease-in-out infinite;
}

@keyframes pulse-dot {
  0%, 100% { opacity: 1; }
  50%       { opacity: 0.4; }
}
</style>
